<div class="uk-card uk-card-default uk-card-hover uk-card-body layout-row" style="display: flex; margin-bottom: 15px; max-width: 80%;">
    <span style="margin-right: auto; width: 80%;">
        <div class="layout-row">
            <% if (a_username != null) { %>
            <p style="margin-right:10px"><%- a_username %></p>
            <% } else { %>
            <p style="margin-right:10px">(ì•Œìˆ˜ì—†ìŒ)</p>
            <% } %>
            <% for(let index = 0; index < 5; index++) { %>
            <% if (index < review.rating) { %>
            <p>â˜…</p>
            <% } else { %>
            <p>â˜†</p>
            <% } %>
            <% } %>
        </div>
        <!--íƒœê·¸ë„£ì„ ê³³-->
        <p>ì´ ì‘ì„±ìì˜ í›„ê¸° í‰ê· : <%- review.rating %></p>
        <% if(tags !== null) { %>
        <% tags.split("").forEach((element, index) => { %>
        <span class="uk-label" style="margin-right:5px; margin-bottom:5px;"><%= tagsData[element] %></span>
        <% }) %>
        <% } %>
        <p class="rv-content"><%- review.content %></p>
    </span>

    <span class="layout-column">
        <label style="margin: 10px 0; float: right;"><%= review.created_time %>ì‘ì„±</label>
        <% let isReported = false; %>
        <% if(report != undefined) { %>
            <% report.forEach(repo => { %>
            <% if(repo.repo_rv_id === review.id) isReported = true; }); %>
        <% } %>
        <% if(!isReported) { %>
            <!-- This is a button toggling the modal -->
            <button class="uk-button uk-button-default uk-margin-small-right" type="button" uk-toggle="target: #modal-example-<%= review.id %>">ì‹ ê³ </button>

            <!-- This is the modal -->
            <div id="modal-example-<%= review.id %>" uk-modal>
                <div class="uk-modal-dialog uk-modal-body">
                    <form id="reportForm-<%= review.id %>" method="get">
                    <!-- <form action="/agent/report/<%= review.id %>" method="get"> -->
                        <h2 class="uk-modal-title">ğŸš¨ë‚˜ìœ í›„ê¸°ì…ë‹ˆê¹Œ?ğŸš¨</h2>
                        <label><b>ì‹ ê³  ì‚¬ìœ  ì„ íƒ</b></label>
                        <div class="report-radio-container" name="reason">
                        <label><input style="margin: 15px;" class="uk-radio" type="radio" required="required" name="reason-<%= review.id %>" value="1">ì‚¬ì¹­/ì‚¬ê¸°</label>
                        </br>
                        <label><input style="margin: 15px;" class="uk-radio" type="radio" required="required" name="reason-<%= review.id %>" value="2">ìš•ì„¤/ë¹„í•˜</label>
                        </br>
                        <label><input style="margin: 15px;" class="uk-radio" type="radio" required="required" name="reason-<%= review.id %>" value="3">ë¶€ì ì ˆí•œ ë‚´ìš©</label>
                        </div>
                        <button class="uk-button uk-button-default uk-modal-close" type="button">ì·¨ì†Œ</button>
                        <button class="uk-button uk-button-primary submitBtn" data-rv-id="<%= review.id %>" type="submit">ì‹ ê³ </button>
                    </form>
                </div>
            </div>
        <% } else { %>
            <label style="margin: 10px 0; float: right; text-align: right;">ğŸš”ì‹ ê³  ì™„ë£Œ</label>
        <% } %>
    </span>
</div>

<script>
    document.querySelectorAll('.submitBtn').forEach(button => {
        button.addEventListener('click', function(event) {
            event.preventDefault(); // ê¸°ì¡´ì˜ submit í–‰ë™ì„ ë§‰ìŠµë‹ˆë‹¤.
            const rv_id = this.dataset.rvId; // ì„œë²„ì—ì„œ ë™ì ìœ¼ë¡œ í• ë‹¹ë˜ëŠ” rv_id ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const reason = document.querySelector(`input[name="reason-${rv_id}"]:checked`).value; // ì„ íƒëœ ì‹ ê³  ì‚¬ìœ ì˜ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const form = document.getElementById(`reportForm-${rv_id}`);
            form.action = `/agent/report/${rv_id}/${reason}`; // í¼ì˜ action ì†ì„±ì„ ì„¤ì •í•©ë‹ˆë‹¤.
            form.submit(); // í¼ì„ ì œì¶œí•©ë‹ˆë‹¤.
        });
    });
</script>